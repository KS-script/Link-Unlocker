<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkUnlocker - Get KS Rivals Script</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --youtube: #ff0033;
            --discord: #5865f2;
            --success: #10b981;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
        }

        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            background: #0a0a0f;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Background */
        .bg-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bg-gradient {
            position: absolute;
            width: 150%;
            height: 150%;
            top: -25%;
            left: -25%;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(88, 101, 242, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(255, 0, 51, 0.05) 0%, transparent 50%);
            animation: bgMove 20s ease-in-out infinite;
        }

        @keyframes bgMove {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(2%, 2%) rotate(1deg); }
            50% { transform: translate(-1%, 3%) rotate(-1deg); }
            75% { transform: translate(3%, -2%) rotate(0.5deg); }
        }

        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(139, 92, 246, 0.5);
            border-radius: 50%;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        /* Grid Pattern */
        .grid-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 30s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px); }
        }

        /* Main Container */
        .container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        /* Logo & Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--discord));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 10px 40px rgba(139, 92, 246, 0.3);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 10px 40px rgba(139, 92, 246, 0.3); }
            50% { box-shadow: 0 10px 60px rgba(139, 92, 246, 0.5); }
        }

        .logo-text {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.7) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .title-badge {
            display: inline-block;
            padding: 8px 20px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            font-size: 14px;
            color: var(--primary);
            margin-top: 15px;
            backdrop-filter: blur(10px);
        }

        /* Main Card */
        .main-card {
            width: 100%;
            max-width: 480px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        }

        .card-header {
            text-align: center;
            margin-bottom: 35px;
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .card-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: 35px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .progress-count {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary), var(--discord));
            border-radius: 10px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Task Buttons */
        .tasks {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 35px;
        }

        .task-btn {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 18px 20px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .task-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            transition: left 0.5s;
        }

        .task-btn:hover::before {
            left: 100%;
        }

        .task-btn:hover {
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.05);
        }

        .task-btn.youtube:hover {
            border-color: rgba(255, 0, 51, 0.3);
            box-shadow: 0 10px 40px rgba(255, 0, 51, 0.1);
        }

        .task-btn.discord:hover {
            border-color: rgba(88, 101, 242, 0.3);
            box-shadow: 0 10px 40px rgba(88, 101, 242, 0.1);
        }

        .task-btn.completed {
            border-color: rgba(16, 185, 129, 0.3);
            background: rgba(16, 185, 129, 0.05);
        }

        .task-btn.completed:hover {
            transform: none;
            cursor: default;
        }

        .task-btn.pending {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .task-btn.verifying {
            pointer-events: none;
        }

        .task-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .task-btn.youtube .task-icon {
            background: rgba(255, 0, 51, 0.15);
            color: var(--youtube);
        }

        .task-btn.discord .task-icon {
            background: rgba(88, 101, 242, 0.15);
            color: var(--discord);
        }

        .task-btn.completed .task-icon {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success);
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .task-desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .task-status {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .task-btn:not(.completed) .task-status {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .task-btn.completed .task-status {
            background: var(--success);
            color: white;
        }

        .task-btn.verifying .task-status {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% { transform: rotate(360deg); }
        }

        /* Timer */
        .timer-display {
            font-size: 12px;
            color: var(--primary);
            margin-top: 4px;
            font-weight: 500;
        }

        /* Get Script Button */
        .get-script-btn {
            width: 100%;
            padding: 20px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-family: 'Inter', sans-serif;
        }

        .get-script-btn.locked {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            cursor: not-allowed;
        }

        .get-script-btn.unlocked {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            color: white;
            box-shadow: 
                0 10px 40px rgba(139, 92, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: glow 2s ease-in-out infinite, buttonPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 
                    0 10px 40px rgba(139, 92, 246, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    0 0 60px rgba(139, 92, 246, 0.3);
            }
            50% {
                box-shadow: 
                    0 15px 60px rgba(139, 92, 246, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    0 0 100px rgba(139, 92, 246, 0.5);
            }
        }

        @keyframes buttonPop {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .get-script-btn.unlocked:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 20px 60px rgba(139, 92, 246, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 120px rgba(139, 92, 246, 0.4);
        }

        .get-script-btn.unlocked::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 70%
            );
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            padding: 20px;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: rgba(20, 20, 30, 0.95);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            text-align: center;
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active .modal {
            transform: scale(1) translateY(0);
        }

        .modal-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }

        .modal-icon.verifying {
            background: rgba(139, 92, 246, 0.15);
            color: var(--primary);
            animation: modalPulse 1.5s ease-in-out infinite;
        }

        .modal-icon.success {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success);
        }

        .modal-icon.error {
            background: rgba(239, 68, 68, 0.15);
            color: #ef4444;
        }

        @keyframes modalPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .modal-desc {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .modal-timer {
            font-size: 48px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 24px;
            font-variant-numeric: tabular-nums;
        }

        .modal-btn {
            padding: 14px 32px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
        }

        .modal-btn.primary {
            background: var(--primary);
            color: white;
        }

        .modal-btn.primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .modal-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            margin-left: 12px;
        }

        .modal-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Footer */
        .footer {
            margin-top: 40px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 13px;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Responsive */
        @media (max-width: 520px) {
            .main-card {
                padding: 30px 24px;
            }

            .logo-text {
                font-size: 26px;
            }

            .card-title {
                font-size: 20px;
            }

            .task-btn {
                padding: 14px 16px;
            }

            .task-icon {
                width: 42px;
                height: 42px;
                font-size: 18px;
            }

            .task-title {
                font-size: 14px;
            }

            .task-desc {
                font-size: 12px;
            }
        }

        /* Confetti */
        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
        }

        /* Success Particles */
        .success-particle {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div class="bg-container">
        <div class="bg-gradient"></div>
        <div class="grid-pattern"></div>
        <div class="particles" id="particles"></div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-unlock-alt"></i>
                </div>
                <span class="logo-text">LinkUnlocker</span>
            </div>
            <p class="subtitle">Complete tasks to unlock your content</p>
            <span class="title-badge">ðŸŽ® Get KS Rivals Script</span>
        </header>

        <main class="main-card">
            <div class="card-header">
                <h1 class="card-title">Unlock Your Script</h1>
                <p class="card-desc">Complete all 3 simple tasks below to get instant access to the exclusive KS Rivals script.</p>
            </div>

            <div class="progress-container">
                <div class="progress-header">
                    <span class="progress-label">Completion Progress</span>
                    <span class="progress-count" id="progressCount">0/3 Tasks</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="tasks">
                <button class="task-btn youtube" id="task1" data-task="subscribe">
                    <div class="task-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="task-content">
                        <div class="task-title">Subscribe to Channel</div>
                        <div class="task-desc">Subscribe to KS Script on YouTube</div>
                        <div class="timer-display" id="timer1"></div>
                    </div>
                    <div class="task-status" id="status1">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                </button>

                <button class="task-btn youtube" id="task2" data-task="like">
                    <div class="task-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="task-content">
                        <div class="task-title">Like the Video</div>
                        <div class="task-desc">Like our latest YouTube Short</div>
                        <div class="timer-display" id="timer2"></div>
                    </div>
                    <div class="task-status" id="status2">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                </button>

                <button class="task-btn discord" id="task3" data-task="discord">
                    <div class="task-icon">
                        <i class="fab fa-discord"></i>
                    </div>
                    <div class="task-content">
                        <div class="task-title">Join Discord Server</div>
                        <div class="task-desc">Join our community for updates</div>
                        <div class="timer-display" id="timer3"></div>
                    </div>
                    <div class="task-status" id="status3">
                        <i class="fas fa-arrow-right"></i>
                    </div>
                </button>
            </div>

            <button class="get-script-btn locked" id="getScriptBtn" disabled>
                <i class="fas fa-lock"></i>
                <span>Complete All Tasks to Unlock</span>
            </button>
        </main>

        <footer class="footer">
            <p>Powered by <a href="#">KS Script</a> â€¢ Secure Verification System</p>
        </footer>
    </div>

    <!-- Verification Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-icon verifying" id="modalIcon">
                <i class="fas fa-spinner fa-spin"></i>
            </div>
            <h2 class="modal-title" id="modalTitle">Verifying...</h2>
            <p class="modal-desc" id="modalDesc">Please complete the action in the new tab. Do not close this window.</p>
            <div class="modal-timer" id="modalTimer">15</div>
            <div class="modal-actions">
                <button class="modal-btn secondary" id="modalClose" style="display: none;">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Anti-tampering & State Management
        (function() {
            'use strict';

            // Encrypted storage keys
            const _0x4f2a = {
                k1: btoa('ks_task_subscribe_' + new Date().getFullYear()),
                k2: btoa('ks_task_like_' + new Date().getFullYear()),
                k3: btoa('ks_task_discord_' + new Date().getFullYear()),
                ts: btoa('ks_timestamp_' + new Date().getFullYear()),
                cs: btoa('ks_checksum_' + new Date().getFullYear())
            };

            // Configuration
            const CONFIG = {
                VERIFY_TIME: 4, // seconds required on external page
                URLS: {
                    subscribe: 'https://www.youtube.com/@KS_SCRIPT_Owner?sub_confirmation=1',
                    like: 'https://www.youtube.com/shorts/bGm4dt_Isrk',
                    discord: 'https://discord.com/channels/@me',
                    reward: 'https://ks-script.github.io/KS.WEB/'
                }
            };

            // State
            let state = {
                tasks: {
                    subscribe: false,
                    like: false,
                    discord: false
                },
                verifying: null,
                timerInterval: null,
                sessionId: generateSessionId()
            };

            // Generate unique session ID
            function generateSessionId() {
                return 'xxxx-xxxx-xxxx'.replace(/x/g, () => 
                    Math.floor(Math.random() * 16).toString(16)
                );
            }

            // Compute checksum for anti-tampering
            function computeChecksum(data) {
                let hash = 0;
                const str = JSON.stringify(data) + state.sessionId;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return hash.toString(36);
            }

            // Save state with encryption
            function saveState() {
                try {
                    const timestamp = Date.now();
                    const checksum = computeChecksum(state.tasks);
                    
                    Object.keys(state.tasks).forEach((key, idx) => {
                        const storageKey = _0x4f2a[`k${idx + 1}`];
                        const value = state.tasks[key] ? btoa(timestamp + '_' + state.sessionId) : '';
                        localStorage.setItem(storageKey, value);
                    });
                    
                    localStorage.setItem(_0x4f2a.ts, btoa(timestamp.toString()));
                    localStorage.setItem(_0x4f2a.cs, btoa(checksum));
                } catch (e) {
                    console.error('Storage error');
                }
            }

            // Load state with validation
            function loadState() {
                try {
                    const storedTimestamp = localStorage.getItem(_0x4f2a.ts);
                    if (!storedTimestamp) return;

                    const timestamp = parseInt(atob(storedTimestamp));
                    const now = Date.now();
                    const maxAge = 24 * 60 * 60 * 1000; // 24 hours

                    // Expire old data
                    if (now - timestamp > maxAge) {
                        clearState();
                        return;
                    }

                    // Load task states
                    const keys = ['subscribe', 'like', 'discord'];
                    keys.forEach((key, idx) => {
                        const storageKey = _0x4f2a[`k${idx + 1}`];
                        const value = localStorage.getItem(storageKey);
                        if (value) {
                            try {
                                const decoded = atob(value);
                                if (decoded.includes('_')) {
                                    state.tasks[key] = true;
                                }
                            } catch (e) {
                                state.tasks[key] = false;
                            }
                        }
                    });

                    updateUI();
                } catch (e) {
                    clearState();
                }
            }

            // Clear state
            function clearState() {
                Object.values(_0x4f2a).forEach(key => {
                    localStorage.removeItem(key);
                });
            }

            // Update UI
            function updateUI() {
                const completed = Object.values(state.tasks).filter(v => v).length;
                const total = 3;
                const percentage = (completed / total) * 100;

                // Update progress
                document.getElementById('progressFill').style.width = `${percentage}%`;
                document.getElementById('progressCount').textContent = `${completed}/${total} Tasks`;

                // Update task buttons
                const tasks = ['subscribe', 'like', 'discord'];
                tasks.forEach((task, idx) => {
                    const btn = document.getElementById(`task${idx + 1}`);
                    const status = document.getElementById(`status${idx + 1}`);

                    if (state.tasks[task]) {
                        btn.classList.add('completed');
                        btn.classList.remove('pending', 'verifying');
                        status.innerHTML = '<i class="fas fa-check"></i>';
                    } else {
                        btn.classList.remove('completed', 'verifying');
                        status.innerHTML = '<i class="fas fa-arrow-right"></i>';
                    }
                });

                // Update main button
                const mainBtn = document.getElementById('getScriptBtn');
                if (completed === total) {
                    mainBtn.classList.remove('locked');
                    mainBtn.classList.add('unlocked');
                    mainBtn.disabled = false;
                    mainBtn.innerHTML = '<i class="fas fa-unlock"></i><span>Get Your Script Now!</span>';
                    celebrateUnlock();
                } else {
                    mainBtn.classList.add('locked');
                    mainBtn.classList.remove('unlocked');
                    mainBtn.disabled = true;
                    mainBtn.innerHTML = `<i class="fas fa-lock"></i><span>Complete All Tasks to Unlock</span>`;
                }
            }

            // Show modal
            function showModal(type, title, desc, showTimer = false) {
                const overlay = document.getElementById('modalOverlay');
                const icon = document.getElementById('modalIcon');
                const titleEl = document.getElementById('modalTitle');
                const descEl = document.getElementById('modalDesc');
                const timerEl = document.getElementById('modalTimer');
                const closeBtn = document.getElementById('modalClose');

                icon.className = `modal-icon ${type}`;
                if (type === 'verifying') {
                    icon.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                } else if (type === 'success') {
                    icon.innerHTML = '<i class="fas fa-check"></i>';
                } else {
                    icon.innerHTML = '<i class="fas fa-times"></i>';
                }

                titleEl.textContent = title;
                descEl.textContent = desc;
                timerEl.style.display = showTimer ? 'block' : 'none';
                closeBtn.style.display = type !== 'verifying' ? 'inline-block' : 'none';

                overlay.classList.add('active');
            }

            // Hide modal
            function hideModal() {
                document.getElementById('modalOverlay').classList.remove('active');
            }

            // Start task verification
            function startTask(taskName) {
                if (state.tasks[taskName] || state.verifying) return;

                state.verifying = taskName;
                const taskIdx = ['subscribe', 'like', 'discord'].indexOf(taskName) + 1;
                const btn = document.getElementById(`task${taskIdx}`);
                const timerDisplay = document.getElementById(`timer${taskIdx}`);
                
                btn.classList.add('verifying');

                // Open external URL
                const popup = window.open(CONFIG.URLS[taskName], '_blank');

                showModal('verifying', 'Verifying Action...', 
                    'Please complete the action in the new tab. Keep this window open.', true);

                let timeLeft = CONFIG.VERIFY_TIME;
                const timerEl = document.getElementById('modalTimer');
                timerEl.textContent = timeLeft;

                // Focus detection
                let focusLost = false;
                let focusLostTime = 0;

                const focusHandler = () => {
                    if (focusLost && Date.now() - focusLostTime > 2000) {
                        // User came back after being away
                    }
                };

                const blurHandler = () => {
                    focusLost = true;
                    focusLostTime = Date.now();
                };

                window.addEventListener('focus', focusHandler);
                window.addEventListener('blur', blurHandler);

                state.timerInterval = setInterval(() => {
                    timeLeft--;
                    timerEl.textContent = timeLeft;
                    timerDisplay.textContent = `Verifying... ${timeLeft}s`;

                    if (timeLeft <= 0) {
                        clearInterval(state.timerInterval);
                        window.removeEventListener('focus', focusHandler);
                        window.removeEventListener('blur', blurHandler);

                        // Verification logic
                        const verified = focusLost && (Date.now() - focusLostTime > 3000 || !document.hasFocus());

                        if (verified || focusLost) {
                            completeTask(taskName, taskIdx);
                        } else {
                            failTask(taskName, taskIdx);
                        }
                    }
                }, 1000);
            }

            // Complete task
            function completeTask(taskName, taskIdx) {
                state.tasks[taskName] = true;
                state.verifying = null;
                saveState();

                const btn = document.getElementById(`task${taskIdx}`);
                const timerDisplay = document.getElementById(`timer${taskIdx}`);
                
                btn.classList.remove('verifying');
                timerDisplay.textContent = '';

                showModal('success', 'Task Completed!', 
                    'Great job! You\'ve successfully completed this task.');

                setTimeout(() => {
                    hideModal();
                    updateUI();
                }, 1500);

                // Add success particle effect
                createSuccessParticles(btn);
            }

            // Fail task
            function failTask(taskName, taskIdx) {
                state.verifying = null;

                const btn = document.getElementById(`task${taskIdx}`);
                const timerDisplay = document.getElementById(`timer${taskIdx}`);
                
                btn.classList.remove('verifying');
                timerDisplay.textContent = '';

                showModal('error', 'Verification Failed', 
                    'Please make sure to complete the action in the new tab and stay there for the required time.');

                setTimeout(hideModal, 3000);
            }

            // Success particles
            function createSuccessParticles(element) {
                const rect = element.getBoundingClientRect();
                const colors = ['#10b981', '#8b5cf6', '#5865f2', '#fff'];

                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'success-particle';
                    particle.style.left = rect.left + rect.width / 2 + 'px';
                    particle.style.top = rect.top + rect.height / 2 + 'px';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    document.body.appendChild(particle);

                    const angle = (Math.PI * 2 * i) / 20;
                    const velocity = 5 + Math.random() * 5;
                    const vx = Math.cos(angle) * velocity;
                    const vy = Math.sin(angle) * velocity;

                    let x = 0, y = 0, opacity = 1;

                    const animate = () => {
                        x += vx;
                        y += vy + 0.5;
                        opacity -= 0.02;

                        particle.style.transform = `translate(${x}px, ${y}px)`;
                        particle.style.opacity = opacity;

                        if (opacity > 0) {
                            requestAnimationFrame(animate);
                        } else {
                            particle.remove();
                        }
                    };

                    requestAnimationFrame(animate);
                }
            }

            // Celebration effect
            function celebrateUnlock() {
                const colors = ['#8b5cf6', '#10b981', '#5865f2', '#ff0033', '#fff'];
                
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * window.innerWidth + 'px';
                        confetti.style.top = '-20px';
                        confetti.style.width = (Math.random() * 10 + 5) + 'px';
                        confetti.style.height = confetti.style.width;
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                        document.body.appendChild(confetti);

                        let y = 0;
                        let x = 0;
                        const vx = (Math.random() - 0.5) * 4;
                        const vy = Math.random() * 3 + 2;
                        const rotation = Math.random() * 360;
                        let opacity = 1;

                        const animate = () => {
                            y += vy;
                            x += vx;
                            opacity -= 0.01;

                            confetti.style.transform = `translate(${x}px, ${y}px) rotate(${rotation + y}deg)`;
                            confetti.style.opacity = opacity;

                            if (y < window.innerHeight && opacity > 0) {
                                requestAnimationFrame(animate);
                            } else {
                                confetti.remove();
                            }
                        };

                        requestAnimationFrame(animate);
                    }, i * 30);
                }
            }

            // Create background particles
            function createParticles() {
                const container = document.getElementById('particles');
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDuration = (10 + Math.random() * 20) + 's';
                    particle.style.animationDelay = (Math.random() * 10) + 's';
                    particle.style.opacity = Math.random() * 0.5 + 0.2;
                    container.appendChild(particle);
                }
            }

            // Event Listeners
            document.getElementById('task1').addEventListener('click', () => startTask('subscribe'));
            document.getElementById('task2').addEventListener('click', () => startTask('like'));
            document.getElementById('task3').addEventListener('click', () => startTask('discord'));

            document.getElementById('getScriptBtn').addEventListener('click', function() {
                if (!this.classList.contains('locked')) {
                    // Final verification before redirect
                    const allComplete = Object.values(state.tasks).every(v => v);
                    if (allComplete) {
                        window.location.href = CONFIG.URLS.reward;
                    }
                }
            });

            document.getElementById('modalClose').addEventListener('click', hideModal);

            // Anti-devtools
            (function() {
                const threshold = 160;
                setInterval(() => {
                    if (window.outerHeight - window.innerHeight > threshold || 
                        window.outerWidth - window.innerWidth > threshold) {
                        // DevTools might be open, but don't break functionality
                    }
                }, 1000);
            })();

            // Initialize
            createParticles();
            loadState();
            updateUI();
        })();
    </script>
</body>
</html>
